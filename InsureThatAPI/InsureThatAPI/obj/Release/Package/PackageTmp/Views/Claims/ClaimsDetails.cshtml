@model InsureThatAPI.Models.ClaimsDetails
@{
    ViewBag.Title = "Claims Details";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 policy-indiv-head">
    <h4><span>RURAL LIFESTYLE POLICY</span> / CLAIMS</h4>
</div>
<div class="col-lg-9 col-md-9 col-sm-9 col-xs-12 endorsmentview">
    <div class="col-lg-9 col-md-9 col-sm-9 col-xs-12 policy-full-head">
        <h2>CLAIMS DETAILS</h2>
    </div>
    @using (Ajax.BeginForm("ClaimsDetails", "Claims", new AjaxOptions()
    {
        HttpMethod = "POST"

    }, new { @id = "claimsDetails", @name = "claimsDetails" }))
    {
        @Html.AntiForgeryToken()
        <div class="clearfix mb-md-30 mt-10 mb-10">
            <p class="col-md-4 col-sm-4 col-xs-12">Claim Type</p>
            <div class="col-md-8 col-sm-8 col-xs-12">
                @Html.DropDownListFor(p => p.ClaimtypeObj.Type, @Model.ClaimtypeObj.ClaimTypeList, new { @class = "form-control form-border-bottom vlidationInsure commondataselection", @data_eiid = @Model.ClaimtypeObj.EiId, @id = "type" })
                @Html.HiddenFor(p => p.ClaimtypeObj.EiId)
                <label id="ClaimtypeObj.Type-error" class="error" for="ClaimtypeObj.Type"></label>
            </div>
        </div>
        <div class="clearfix mb-md-30 mt-10 mb-10">
            <p class="col-md-4 col-sm-4 col-xs-12">Details of Claim</p>
            <div class="col-md-8 col-sm-8 col-xs-12">
                @Html.TextBoxFor(p => p.DetailsclaimObj.Details, new { @class = "form-control form-border-bottom vlidationInsure commondatatest", @data_eiid = @Model.DetailsclaimObj.EiId, @id = "details" })
                @Html.HiddenFor(p => p.DetailsclaimObj.EiId)
                <label id="DetailsclaimObj.Details-error" class="error" for="DetailsclaimObj.Details"></label>
            </div>
        </div>
        <div class="clearfix mb-md-30 mt-10 mb-10">
            <p class="col-md-4 col-sm-4 col-xs-12">Claim Value</p>
            <div class="col-md-8 col-sm-8 col-xs-12">
                @Html.TextBoxFor(p => p.ClaimvalueObj.Cvalue, new { @class = "form-control form-border-bottom vlidationInsure commondatatest", @data_eiid = @Model.ClaimvalueObj.EiId, @id = "cvalue" })
                @Html.HiddenFor(p => p.ClaimvalueObj.EiId)
                <label id="ClaimvalueObj.Cvalue-error" class="error" for="ClaimvalueObj.Cvalue"></label>
            </div>
        </div>
        <div class="clearfix mb-md-30 mt-10 mb-10">
            <p class="col-md-4 col-sm-4 col-xs-12">Claim Year</p>
            <div class="col-md-8 col-sm-8 col-xs-12">
                @Html.TextBoxFor(p => p.YearObj.Year, new { @class = "form-control form-border-bottom vlidationInsure year commondatatest", @data_eiid = @Model.YearObj.EiId, @id = "year", @readonly = "readonly", @style = "background:none;" })
                @Html.HiddenFor(p => p.YearObj.EiId)
                <label id="YearObj.Date-error" class="error" for="YearObj.Date"></label>
            </div>
        </div>
        <div class="clearfix mb-md-30 mt-10 mb-10">
            <p class="col-md-4 col-sm-4 col-xs-12">Insurer</p>
            <div class="col-md-8 col-sm-8 col-xs-12">
                @Html.TextBoxFor(p => p.InsurerObj.Insurer, new { @class = "form-control form-border-bottom vlidationInsure commondatatest", @data_eiid = @Model.InsurerObj.EiId, @id = "insurer" })
                @Html.HiddenFor(p => p.InsurerObj.EiId)
                <label id="InsurerObj.Insurer-error" class="error" for="InsurerObj.Insurer"></label>
            </div>
        </div>
        <div class="clearfix mb-md-30 mt-10 mb-10">
            <p class="col-md-4 col-sm-4 col-xs-12">Driver</p>
            <div class="col-md-8 col-sm-8 col-xs-12">
                @Html.TextBoxFor(p => p.DriverObj.Driver, new { @class = "form-control form-border-bottom vlidationInsure commondatatest", @data_eiid = @Model.DriverObj.EiId, @id = "driver" })
                @Html.HiddenFor(p => p.DriverObj.EiId)
                <label id="DriverObj.Driver-error" class="error" for="DriverObj.Driver"></label>
            </div>
        </div>        
        <div class="col-md-6 pull-right text-right mt-30">
            <button type="submit" class="button-3d nomargin tab-linker quot-next-btn">Submit</button>
        </div>
    }
</div>
<div class="col-lg-3 col-md-3 col-sm-3 col-xs-12 policy-side-wrap">
    <h3>Policy Sections</h3>
    <div class="well">
        <div class="policy-loc-row">
            <input type="radio" name="location1" id="location1" /><label for="radio1"><span><span></span></span>Home Building Location 1</label>
            <script type="text/javascript">
                $(document).ready(function () {
                    $('#location1').click(function () {
                        $("#policy-ed-del-wrap1").fadeIn('slow');
                        $("#policy-ed-del-wrap2").fadeOut('slow');
                    });
                });
            </script>
            <div id="policy-ed-del-wrap1" class="policy-ed-del-wrapper" style="display: none;">
                <a class="btn color-bk-btn policy-edit-wrap" href="#">Edit</a>&nbsp; <a class="btn color-bk-btn policy-delet-wrap" href="#">Delete</a>
            </div>
        </div>
        <div class="policy-loc-row">
            <input type="radio" name="location1" id="location2" /><label for="radio1"><span><span></span></span>Valuables</label>
            <script type="text/javascript">
                $(document).ready(function () {
                    $('#location2').click(function () {
                        $("#policy-ed-del-wrap2").fadeIn('slow');
                        $("#policy-ed-del-wrap1").fadeOut('slow');
                    });
                });
            </script>
            <div id="policy-ed-del-wrap2" class="policy-ed-del-wrapper" style="display: none;">
                <a class="btn color-bk-btn policy-edit-wrap" href="#">Edit</a>&nbsp; <a class="btn color-bk-btn policy-delet-wrap" href="#">Delete</a>
            </div>
        </div>
        <div class="clearfix"></div>
        <div class="dropdown pc pc-in">
            <a class="new-cover-policy" href="#">New Cover</a>
            <ul class="dropdown-menu col-md-12 unit">
                <li><a href="javascript:void(0);" class="HomeBuilding">+  Home Buildings</a></li>
                <li><a href="javascript:void(0);" class="HomeContent">+  Home Content</a></li>
                <li><a href="javascript:void(0);" class="FarmProperty">+  Farm Property</a></li>
                <li><a href="javascript:void(0);" class="Valuables">+  Valuables</a></li>
                <li><a href="javascript:void(0);" class="Motors">+  Motor</a></li>
                <li><a href="javascript:void(0);" class="Pets">+  Pets</a></li>
                <li><a href="javascript:void(0);" class="Liabilities">+  Liabilities </a></li>
                <li><a href="javascript:void(0);" class="Travel">+  Travel</a></li>
                <li><a href="javascript:void(0);" class="Boat">+  Boat</a></li>
            </ul>
            <script type="text/javascript">
                $(document).on('click', 'ul.unit > li', function () {
                    var nClass = $(this).children("a").attr("class");
                    alert(nClass);
                });
            </script>
        </div>
    </div>
</div>
<script src="~/js/datepicker.min.js"></script>
<script type="text/javascript">
    $(function () {
        $(".year").datepicker({
            minViewMode: 2,
            format: 'yyyy'
        });
    });
</script>
<script type="text/javascript" src="~/Scripts/jquery.validate.js"></script>
<script type="text/javascript" src="~/Scripts/additional-methods.js"></script>
<script type="text/javascript">
    $(document).ready(function () {
        $.validator.addMethod("regex", function (value, element, regexp) {
            if (regexp.constructor != RegExp)
                regexp = new RegExp(regexp);
            else if (regexp.global)
                regexp.lastIndex = 0;
            return this.optional(element) || regexp.test(value);
        }, "Please check your input.");
        $("form[name='claimsDetails']").validate({
            rules: {                
                "ClaimtypeObj.Type": "required",
                "DetailsclaimObj.Details": {
                    required: true,
                    regex: /^[a-zA-Z ]*$/,
                },
                "ClaimvalueObj.Cvalue": {
                    required: true,
                    regex: /^[0-9]*$/,
                },
                "YearObj.Year": "required",
                "InsurerObj.Insurer": {
                    required: true,
                    regex: /^[a-zA-Z ]*$/,
                },
                "DriverObj.Driver": {
                    required: true,
                    regex: /^[a-zA-Z ]*$/,
                },
            },
            messages: {
                "ClaimtypeObj.Type": "Please select claim type",
                "DetailsclaimObj.Details": {
                    required: "Please enter details of claim",
                    regex: "Special character & numeric not allowed",
                },                
                "ClaimvalueObj.Cvalue": {
                    required: "Please enter claim value",
                    regex: "Only numeric are allowed",
                },
                "YearObj.Year": "Please select year",
                "InsurerObj.Insurer": {
                    required: "Please enter insurer",
                    regex: "Special character & numeric not allowed",
                },
                "DriverObj.Driver": {
                    required: "Please enter driver",
                    regex: "Special character & numeric not allowed",
                },
            },
            onfocusout: function (element) {
                this.element(element);
            },
            submitHandler: function (form) {
                form.submit();
            }
        });
        $(document).on('change', '.commondataselection', function () {
            var Value = $(this).val();
            var EIId = $(this).data('eiid');
            var ItId = "0";
            elementAjaxCall(Value, EIId, ItId);
        });
        $(document).on('change', '.commondataradio', function () {
            var Value = $(this).val();
            var EIId = $(this).data('eiid');
            var ItId = "0";
            elementAjaxCall(Value, EIId, ItId);
        });
        $(document).on('focusout', ".commondatatest", function () {
            var Value = $(this).val();
            var EIId = $(this).data('eiid');
            var ItIdN = $(this).data('itid');
            if (ItIdN == 'undefined' || ItIdN == "") {
                var ItId = "0";
            } else {
                var ItId = ItIdN;
            }
            if (Value != "") {
                elementAjaxCall(Value, EIId, ItId);
            }
        });
        $("#premium").click(function () {
            $.ajax({
                url: '/Customer/PremiumDetails',
                type: "POST",
                crossOrigin: true,
                data: {},
                success: function (data) {
                    if (data.Status == true) {
                        var html1 = "";
                        if (!$.isEmptyObject(data.Premium) && data.Premium.length > 0) {
                            var html = "";
                            $.each(data.Premium, function (index, value) {
                                html += '<tr><td>' + value.SectionName + '</td><td>$' + value.Base + '</td><td>$' + value.Fsl + '</td><td>$' + value.Gst + '</td><td>$' + value.StampDuty + '</td><td>$' + value.Gross + '</td></tr>';
                            });
                            if (html != '') {
                                $('#premiumModel-p-b').html(html);
                            }
                        }
                        if (data.UnderwriterFee != null) {
                            html1 += '<tr><td colspan="5">Under Writer Fee</td><td>$' + data.UnderwriterFee + '<td></tr>';
                        }
                        if (data.FeeGst != null) {
                            html1 += '<tr><td colspan="5">Fee Gst</td><td>$' + data.FeeGst + '<td></tr>';
                        }
                        if (data.InvoiceTotal != null) {
                            html1 += '<tr><td colspan="5">Invoice Total</td><td>$' + data.InvoiceTotal + '<td></tr>';
                        }
                        if (html1 != '') {
                            $('#premiumModel-p-f').html(html1);
                        }
                    }
                }
            });

        });
    });
    function elementAjaxCall(Value, EIId, ItId) {
        if (Value != '' && EIId != '') {
            $.ajax({
                url: '/Customer/ElementDetails',
                type: "POST",
                crossOrigin: true,
                data: { "PrId": "1029", "ElId": EIId, "Value": Value, "ItId": ItId },
                success: function (data) {
                    if (!$.isEmptyObject(data.valuedata) && data.valuedata.length > 0) {
                        var valuedata = data.valuedata;
                        if (valuedata != '' && valuedata != null) {
                            $.each(valuedata, function (index, value) {
                                var StateIdNewOne = $("[data-eiid=" + value.Element.ElId + "]").attr('id');
                                //$('#' + StateIdNewOne).val(value.Value);
                                if (!$.isEmptyObject(data.stateData) && data.stateData.length > 0) {
                                    var statedata = data.stateData;
                                    if (statedata != '' && statedata != null) {
                                        $.each(statedata, function (index1, value1) {
                                            var StateIdNew = $("[data-eiid=" + value1.Element.ElId + "]").attr('id');
                                            if (value1.Value == 'Invisible') {
                                                $('#' + StateIdNew).removeAttr('readonly');
                                                $('#' + StateIdNew).removeAttr('disabled');
                                                $('#' + StateIdNew).css({ 'text-decoration': '' });
                                                $('.cl-' + value1.Element.ElId).css({ 'display': 'none' });
                                                $('#' + StateIdNew).removeAttr('required', 'required');
                                            } else if (value1.Value == 'Disabled') {
                                                $('#' + StateIdNew).attr('disabled', 'disabled');
                                                $('#' + StateIdNew).removeAttr('readonly');
                                                $('#' + StateIdNew).css({ 'text-decoration': '' });
                                                $('.cl-' + value1.Element.ElId).css({ 'display': 'block' });
                                                $('#' + StateIdNew).removeAttr('required', 'required');
                                            } else if (value1.Value == 'Read Only') {
                                                $('#' + StateIdNew).attr('readonly', 'readonly');
                                                $('#' + StateIdNew).removeAttr('disabled');
                                                $('#' + StateIdNew).css({ 'text-decoration': '' });
                                                $('.cl-' + value1.Element.ElId).css({ 'display': 'block' });
                                                $('#' + StateIdNew).removeAttr('required', 'required');
                                            } else if (value1.Value == 'Strike Through') {
                                                $('#' + StateIdNew).css({ 'text-decoration': 'line-through' });
                                                $('#' + StateIdNew).removeAttr('readonly');
                                                $('#' + StateIdNew).removeAttr('disabled');
                                                $('.cl-' + value1.Element.ElId).css({ 'display': 'block' });
                                                $('#' + StateIdNew).removeAttr('required', 'required');
                                            } else if (value1.Value == 'Required') {
                                                $('#' + StateIdNew).css({ 'text-decoration': 'line-through' });
                                                $('#' + StateIdNew).removeAttr('readonly');
                                                $('#' + StateIdNew).removeAttr('disabled');
                                                $('.cl-' + value1.Element.ElId).css({ 'display': 'block' });
                                                $('#' + StateIdNew).attr('required', 'required');
                                            } else if (value1.Value == '"Not Rendered') {
                                                $('#' + StateIdNew).css({ 'text-decoration': '' });
                                                $('#' + StateIdNew).removeAttr('readonly');
                                                $('#' + StateIdNew).removeAttr('disabled');
                                                $('.cl-' + value1.Element.ElId).css({ 'display': 'block' });
                                                $('#' + StateIdNew).removeAttr('required', 'required');
                                            }

                                        });
                                    }
                                }
                            });
                        }
                    }
                    if (data.referrallist != null || data.referrallist != "") {
                        $('#referralList-p').html('No Referral List');
                    } else {
                        $('#referralList-p').html(data.referrallist);
                    }
                }
            });
        }
    }
</script>